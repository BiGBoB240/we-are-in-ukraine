<?php
function filter_bad_words($text) {
    // Основные маты и их формы
    $russianBadWords = [
        // Матерные слова на "б"
        'бля[дт][ьъ]?', 'бля[тд]и?н(?:а|у|е|ы|ой|ою|е|ам|ами|ах)?', 'бляд[юя]', 'бля[тд]е?н[юя]',
        // Матерные слова на "е"
        'еба(?:ть|л|ла|ло|ли|нный|нн[а-я]*|т[ье]?|н[а-я]*)', 'ёб(?:ан)?(?:у|е|а|о)?',
        // Матерные слова на "ж"
        'жоп[а-я]*',
        // Матерные слова на "з"
        'залуп[а-я]*', 'зло[бд]?[её]б[а-я]*',
        // Матерные слова на "м"
        'манда[а-я]*', 'муд[ае]?[кчш][а-я]*', 'мраз[а-я]*', 'мразот[а-я]*',
        // Матерные слова на "н"
        'на[хъ]?[уё]', 'на[хъ]?[уё][йе]',
        // Матерные слова на "о"
        'отсос[а-я]*',
        // Матерные слова на "п"
        'педера[сcт][т]?[а-я]*', 'педик[а-я]*', 'п[её]зд[а-я]*', 'пид[ао]р[а-я]*',
        'пидр[а-я]*', 'пизд[а-я]*', 'пи[зс]д[аеёийоуыэюя]', 'под[о]?[сб][сб]?[аеёийоуыэюя]',
        // Матерные слова на "р"
        'разъ[её]б[а-я]*', 'съ?[её]б[а-я]*',
        // Матерные слова на "с"
        'с[с]?ук[аио]', 'сучк[а-я]*', 'суч[оё]н[а-я]*', 'сучи[йх]?',
        // Матерные слова на "х"
        'х[уy][йяюиеё][лдц]?[а-я]*', 'хер[а-я]*', 'херн[яе]', 'хо[хy][тт]?[а-я]*',
        'х[уy]л[её][а-я]*', 'х[уy]йн[яю]', 'х[уy][йя]'
    ];

    $ukrainianBadWords = [
        // Матерні слова на "б"
        'бля[тд]ь?', 'бля[тд]і?н(?:а|у|е|и|ою|і|ам|ами|ах)?', 'бляд[юя]', 'бля[тд]е?н[юя]',
        'бзд[юя]х[а-я]*', 'бзд[юя]ш[а-я]*', 'бздю[клмн][а-я]*',
        // Матерні слова на "г"
        'г[ао]ндон[а-я]*', 'г[ао]вн[а-я]*', 'г[ао]вн[юя]д[а-я]*',
        // Матерні слова на "д"
        'д[еи]б[ії]л[а-я]*', 'д[еи]б[ії]льн[а-я]*', 'д[еи]р[ао]ч[а-я]*', 'д[іи]рк[ао][а-я]*',
        // Матерні слова на "з"
        'залуп[а-я]*',
        // Матерні слова на "й"
        'йобан[а-я]*', 'йобнут[а-я]*',
        // Матерні слова на "к"
        'кал[а-я]*', 'кретин[а-я]*', 'курв[а-я]*',
        // Матерні слова на "л"
        'лох[а-я]*', 'лахудр[а-я]*', 'лошар[а-я]*', 'луз[её]р[а-я]*',
        // Матерні слова на "м"
        'муд[аеи]?[кчш][а-я]*', 'муда[кч][а-я]*', 'мудил[а-я]*', 'мудозв[а-я]*',
        'мраз[а-я]*', 'мразот[а-я]*',
        // Матерні слова на "н"
        'на[хх]?[уy][йяюиеё]', 'нах[уy][йя]', 'нах[уy]йник[а-я]*',
        // Матерні слова на "о"
        'остолоп[а-я]*', 'ост[ое]рв[а-я]*', 'отмороз[а-я]*', 'отс[ао]с[а-я]*',
        // Матерні слова на "п"
        'падл[ао][а-я]*', 'падлюк[а-я]*', 'педер[а-я]*', 'педик[а-я]*', 'п[еи]зд[а-я]*',
        'п[іи]д[ао]р[а-я]*', 'п[іи]др[а-я]*', 'п[іи]зд[а-я]*', 'п[іи]сд[а-я]*',
        'подл[юя]г[а-я]*', 'придур[а-я]*', 'путін[а-я]*', 'путл[а-я]*',
        // Матерні слова на "р"
        'роз\'[аеи]б[а-я]*', 'роз\'[аеи]б[а-я]*йоб[а-я]*', 'роз\'[аеи]б[а-я]*срак[а-я]*',
        // Матерні слова на "с"
        'сволоч[а-я]*', 'сволоч[а-я]*', 'свин[а-я]*', 'свинор[а-я]*', 'сран[а-я]*',
        'сран[ьъ]?[её]?[а-я]*', 'срун[а-я]*', 'ссан[а-я]*', 'ссуч[а-я]*',
        'сук[аио][а-я]*', 'сучар[а-я]*', 'сучен[ья][а-я]*', 'сучк[а-я]*',
        // Матерні слова на "т"
        'тел[еи]х[а-я]*', 'тел[еи]ш[а-я]*', 'твар[ию][а-я]*', 'тварюк[а-я]*',
        'туп[аеи][а-я]*', 'туп[аеи]зв[а-я]*', 'туп[аеи]йоб[а-я]*',
        // Матерні слова на "у"
        'ублюд[а-я]*', 'убог[а-я]*', 'уйоб[а-я]*', 'урод[а-я]*', 'у[рp][оo]д[а-я]*',
        // Матерні слова на "ф"
        'фал[ао]с[а-я]*', 'ф[ао]ш[аи]ст[а-я]*', 'ф[іи]г[а-я]*', 'фуфл[а-я]*',
        // Матерні слова на "х"
        'х[уy][йяюиеё][лдц]?[а-я]*', 'хер[а-я]*', 'херн[яе]', 'х[уy]л[её][а-я]*',
        'х[уy]йн[яю]', 'х[уy][йя]', 'х[уy]йл[а-я]*', 'х[уy]та[а-я]*', 'х[уy][їи]*',
        // Матерні слова на "ч"
        'чмо[а-я]*',
        // Матерні слова на "ш"
        'шалав[а-я]*', 'шльондр[а-я]*', 'шмар[а-я]*', 'шмар[а-я]*', 'шльондра[а-я]*',
        // Матерні слова на "я"
        'я[бп]л[а-я]*' 
    ];


    // Английские маты
    $englishBadWords = [
        'fuck', 'shit', 'bitch', 'asshole', 'dick', 'cunt', 'pussy', 'whore', 'slut',
        'dickhead', 'cock', 'piss', 'crap', 'prick', 'twat', 'wanker', 'wank', 'fag', 'faggot',
        'ass', 'bastard', 'dildo', 'jerk', 'nigger', 'retard', 'whore'
    ];

    // Объединяем все слова в один массив
    $allBadWords = array_merge($russianBadWords, $englishBadWords, $ukrainianBadWords);

    foreach ($allBadWords as $word) {
        $pattern = '/(?<=\b|[^а-яёa-z])' . $word . '(?=\b|[^а-яёa-z])/iu';
        $text = preg_replace_callback($pattern, function($matches) {
            return str_repeat('*', mb_strlen($matches[0], 'UTF-8'));
        }, $text);
    }

    return $text;
}